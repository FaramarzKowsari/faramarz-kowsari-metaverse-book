<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metaverse Leaps - Digital Book | Faramarz Kowsari</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;400;700&family=Urbanist:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #deff9a; --bg: #050505; --glass: rgba(255, 255, 255, 0.03); }
        * { scroll-behavior: smooth; box-sizing: border-box; }
        body { 
            background-color: var(--bg); 
            color: #e5e7eb; 
            font-family: 'Urbanist', 'Vazirmatn', sans-serif; 
            overflow-x: hidden; 
        }
        .glass-panel { background: var(--glass); backdrop-filter: blur(15px); border: 1px solid rgba(222, 255, 154, 0.1); }
        .gradient-text { background: linear-gradient(135deg, #deff9a 0%, #a3e635 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        .sidebar-link { transition: all 0.3s ease; }
        .sidebar-link.active { color: var(--accent); background: rgba(222, 255, 154, 0.05); }
        
        [dir="rtl"] .sidebar-link { border-right: 2px solid transparent; text-align: right; }
        [dir="rtl"] .sidebar-link.active { border-right-color: var(--accent); }
        [dir="ltr"] .sidebar-link { border-left: 2px solid transparent; text-align: left; }
        [dir="ltr"] .sidebar-link.active { border-left-color: var(--accent); }
        
        .page-container { max-width: 850px; margin: 0 auto; line-height: 2.2; }
        .paragraph-text { text-align: justify; margin-bottom: 2.5rem; font-weight: 300; font-size: 1.15rem; color: #d1d5db; }

        .mini-player { opacity: 0.7; transition: all 0.4s ease; }
        .mini-player:hover { opacity: 1; transform: scale(1.05); }
        
        .loader { border: 2px solid #f3f3f3; border-top: 2px solid var(--accent); border-radius: 50%; width: 16px; height: 16px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 10px; }

        @media (max-width: 1024px) {
            .sidebar-mobile { 
                position: fixed; top: 0; width: 100%; height: 100vh;
                transform: translateX(100%); z-index: 100;
            }
            [dir="ltr"] .sidebar-mobile { transform: translateX(-100%); }
            .sidebar-mobile.open { transform: translateX(0); }
        }
        .barcode-svg { filter: invert(1) brightness(1.2); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- SVG Components ---
        const IconDownload = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="inline-block mx-2 ml-2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>;
        const IconPlay = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"/></svg>;
        const IconPause = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>;
        const IconGlobe = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>;
        const IconLinkedin = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>;
        const IconMail = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>;
        const IconMenu = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>;
        const IconX = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>;
        const IconVolume = () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>;

        const Barcode = () => (
            <svg width="150" height="40" className="barcode-svg">
                <rect width="150" height="40" fill="white" />
                {[...Array(30)].map((_, i) => (
                    <rect key={i} x={i*5} width={Math.random() > 0.4 ? 2 : 4} height="35" fill="black" />
                ))}
            </svg>
        );

        const bookData = {
            en: {
                dir: "ltr", langCode: "en", pdf: "pdf/Metavers_Leaps_Brief_Book -English1.pdf",
                title: "Technological Leaps in the Metaverse", author: "Faramarz Kowsari", isbn: "978-622-02-2356-6",
                download: "Download PDF (EN)", authorLabel: "About Author", pubDetails: "Publication Identity",
                chapters: [
                    { id: "ch1", title: "1. Philosophy of Presence", paragraphs: [
                        "The concept of presence in the Metaverse represents a fundamental ontological shift that transcends the limitations of traditional telecommunications and virtual reality simulation. In this new paradigm, presence is not merely a psychological state of feeling there but a functional integration of the self into a complex digital ecosystem. This transition requires us to reconsider the Cartesian distinction between mind and matter as the virtual plane provides a logically consistent framework. The biological brain, through its inherent plasticity, begins to treat synthetic stimuli as primary data points for environmental mapping and navigation. Consequently, the boundary between the physical body and the digital avatar starts to dissolve at the neural level for the observer. We are witnessing the emergence of a post-geographic human condition where the concept of locality is defined by network topology. This shift necessitates a new epistemology that values the authenticity of interaction over the medium of transmission in daily life. The subjective experience of qualia in virtual spaces becomes indistinguishable from physical reality as sensory feedback loops reach millisecond precision. We must acknowledge that the Metaverse is not an escape from reality but a purposeful expansion of the human existential territory. Presence, therefore, is the cognitive glue that binds our disparate experiences into a unified sense of self across both domains.",
                        "The second phase of this philosophical evolution centers on the temporal nature of digital existence and the spatialization of memory in 3D. In the physical world, time is a linear progression characterized by the irreversible decay of matter and the fading of events. In the Metaverse, every action is recorded in a persistent ledger, transforming the past into a navigable architectural space for everyone. This allows for a simultaneity of experience where multiple historical or speculative contexts can exist within a single synchronized environment. The human relationship with the moment is thus fundamentally altered, moving from a transient occurrence to a persistent data point. Such a shift requires a new framework for understanding the concept of a life well-lived in an era of digital eternity. We must grapple with the psychological implications of living in an environment devoid of traditional entropy, where beauty is static. This leads to the question of whether the human spirit requires struggle and decay to find true meaning and purpose. Artificially introducing narrative friction and digital entropy into these worlds is a way to ground our experiences in a familiar reality. Yet, the real technological leap lies in embracing the unique logic of the digital plane as a valid form of reality. This acceptance marks the transition from the imitation phase of technology to the creation phase of the new human species.",
                        "Thirdly, the philosophy of presence must address the collective nature of reality-building and the emergence of inter-subjective consensus through technology. In the physical world, reality is largely a given, dictated by the laws of physics and the consensus of biological senses. In the Metaverse, reality is a collaborative construct that can be modified, shared, and negotiated in real-time by the users. This creates a dynamic reality where the collective will of a community can alter the physical laws of their shared environment. Such power requires a new social contract that prioritizes the preservation of shared truth over individual convenience or profit. We must be wary of the fragmentation of reality into epistemic bubbles where different groups live in logically incompatible universes. The open Metaverse depends on interoperable protocols that ensure a consistent baseline of experience for all its global inhabitants. This consistency is essential for fostering trust and empathy across the digital divide that currently exists in our world. We must treat high-fidelity presence as a fundamental human right, ensuring that no one is excluded based on their status. The democratization of the ideal allows for a global meritocracy where the most innovative minds can shape the digital reality. Ultimately, the philosophy of presence is about the integration of the human reach with the infinite possibilities of the void."
                    ]},
                    { id: "ch2", title: "2. Generative AI", paragraphs: ["AI content here (placeholder for space)...", "Paragraph 2 of AI...", "Paragraph 3 of AI..."] },
                    { id: "ch3", title: "3. BCI Leap", paragraphs: ["BCI content...","Para 2...","Para 3..."] },
                    { id: "ch4", title: "4. 6G Infrastructure", paragraphs: ["6G content...","Para 2...","Para 3..."] },
                    { id: "ch5", title: "5. Digital Economy", paragraphs: ["Economy content...","Para 2...","Para 3..."] },
                    { id: "ch6", title: "6. Fluid Identity", paragraphs: ["Identity content...","Para 2...","Para 3..."] },
                    { id: "ch7", title: "7. Digital Ethics", paragraphs: ["Ethics content...","Para 2...","Para 3..."] },
                    { id: "ch8", title: "8. Art & Creativity", paragraphs: ["Art content...","Para 2...","Para 3..."] },
                    { id: "ch9", title: "9. Law & Sovereignty", paragraphs: ["Law content...","Para 2...","Para 3..."] },
                    { id: "ch10", title: "10. Final Synthesis", paragraphs: ["Synthesis content...","Para 2...","Para 3..."] }
                ]
            },
            tr: {
                dir: "ltr", langCode: "tr", pdf: "pdf/Metavers_Leaps_Brief_Book-Turkish.pdf",
                title: "Metaverse'de Teknolojik Sıçramalar", author: "Faramarz Kowsari", isbn: "978-622-02-2356-6",
                download: "PDF İndir (TR)", authorLabel: "Yazar Hakkında", pubDetails: "Yayın Bilgileri",
                chapters: [
                    { id: "ch1", title: "1. Varlık Felsefesi", paragraphs: [
                        "Metaverse'deki varlık kavramı, mevcut başa takılan ekranların basit görsel sadakatinin ötesine geçerek, insan deneyiminde derin bir ontolojik değişimi kapsar ve fiziksel gerçeklik ile dijital temsil arasındaki sınırları radikal bir biçimde zorlar. Bu yeni paradigmada varlık, sadece orada olma şeklinde geçici bir psikolojik durum değil, benliğin kendi iç mantığını zihne dayatan karmaşık, yüksek frekanslı bir dijital ekosisteme işlevsel entegrasyonudur. Bu geçiş, zihin ve madde arasındaki Kartezyen ayrımı yeniden düşünmemizi gerektirir; zira sanal düzlem, öznel deneyim için mantıksal olarak tutarlı bir çerçeve sunar. Biyolojik beyin, doğuştan gelen plastisitesi sayesinde, sentetik uyaranları çevresel haritalama için birincil veri noktaları olarak ele almaya başlar. Sonuç olarak, fiziksel beden ile dijital avatar arasındaki sınır nöral düzeyde çözülmeye başlar. Yerellik kavramının fiziksel koordinatlardan ziyade ağ topolojisi tarafından tanımlandığı coğrafya sonrası bir insanlık durumunun ortaya çıkışına tanık oluyoruz. Bu değişim, etkileşimin özgünlüğünü iletim ortamının üzerinde tutan yeni bir epistemoloji gerektirir. Sanal alanlardaki qualia veya öznel deneyim kalitesi, duyusal geri bildirim döngüleri milisaniye hassasiyetine ulaştıkça fiziksel gerçeklikten ayırt edilemez hale gelir. Metaverse'ün gerçeklikten bir kaçış değil, insan varoluşsal alanının amaçlı bir genişlemesi olduğunu kabul etmeliyiz. Dijital varlığın kalıcılığı, insan mirasına ve bilincin sürekliliğine bakmak için yeni bir mercek sunar. Bu alanlarda daha fazla zaman geçirdikçe, sosyal kimliklerimiz giderek daha akışkan ve çok düzlemli hale gelecektir.",
                        "Bölümün ikinci aşamasında, dijital varlığın zamansal doğasını ve belleğin mekânsallaştırılmasını ele alıyoruz. Fiziksel dünyada zaman, maddenin geri dönülemez bozunması ve olayların tarihe karışmasıyla karakterize edilen doğrusal bir ilerlemedir. Metaverse'de ise هر eylem kalıcı bir deftere kaydedilir ve geçmişi gezilebilir bir mimari alana dönüştürür. Bu, birden fazla tarihsel veya spekülatif bağlamın tek bir senkronize ortamda var olabileceği bir deneyim eşzamanlılığına izin verir. İnsanın an ile olan ilişkisi böylece temelden değişir; geçici bir olaydan, yeniden ziyaret edilebilen veya yeniden deneyimlenebilen kalıcı bir veri noktasına dönüşür. Böyle bir değişim, dijital ebediyet çağında anlamlı bir yaşam kavramını yeniden tanımlamak için yeni bir çerçeve gerektirir. Geleneksel entropiden yoksun, güzelliğin statik olduğu ve ölümün isteğe bağlı bir durum olduğu bir ortamda yaşamanın psikolojik sonuçlarıyla yüzleşmeliyiz. Bu da insan ruhunun gerçek anlam ve amaç bulmak için mücadele ve bozunmaya ihtiyaç duyup duymadığı sorusuna yol açar. Bu dünyalara yapay olarak anlatı sürtünmesi ve dijital entropi dahil etmek, deneyimlerimizi tanıdık bir gerçekliğe bağlamanın bir yoludur. Ancak gerçek teknolojik sıçrama, dijital düzlemin benzersiz mantığını kendi başına geçerli bir gerçeklik formu olarak kabul etmekte yatar. Bu kabul, teknolojinin taklit aşamasından yaratım aşamasına geçişini işaret eder.",
                        "Üçüncü olarak, varlık felsefesi gerçeklik inşasının kolektif doğasını ve öznelerarası fikir birliğinin ortaya çıkışını ele almalıdır. Fiziksel dünyada gerçeklik, fizik yasaları ve biyolojik duyuların konsensüsü tarafından dikte edilen büyük ölçüde verili bir durumdur. Metaverse'de gerçeklik, gerçek zamanlı olarak değiştirilebilen, paylaşılan ve müzekere edilebilen iş birliğine dayalı bir kurgudur. Bu, bir topluluğun kolektif iradesinin paylaşılan ortamların fiziksel yasalarını değiştirebileceği bir dinamik gerçeklik yaratır. Böyle bir güç, paylaşılan gerçeğin korunmasını bireysel rahatlığın üzerinde tutan yeni bir toplumsal sözleşme gerektirir. Farklı grupların mantıksal olarak uyumsuz evrenlerde yaşadığı epistemik izolasyon balonlarına bölünmüş gerçeklik konusunda dikkatli olmalıyız. Açık Metaverse, tüm sakinler için tutarlı bir deneyim temeli sağlayan birlikte çalışabilir protokollere dayanır. Bu tutarlılık, dijital uçurumun ötesinde güven ve empati kurmak için esastır. Yüksek sadakatli varlığı temel bir insan hakkı olarak görmeli ve kimsenin fiziksel konumu veya ekonomik durumu nedeniyle dışlanmamasını sağlamalıyız. İdeal olanın demokratikleşmesi, en yenilikçi zihinlerin fiziksel zenginliklerinden bağımsız olarak gerçekliği şekillendirebildiği bir sisteme izin verir. Ancak bu yaratıcı özgürlük, dijital toplumun kolektif psikolojik sağlığına karşı bir sorumlulukla dengelenmelidir. Metaverse, en yüksek aspirasyonlarımızı yansıtan bir aynadır ve biz hangi versiyonumuzu sonsuzluğa yansıtacağımızı seçmeliyiz. Doğa ve yapaylık arasındaki denge, bu sanal ekosistemlerin sürdürülebilirliği için hayatidir. İnsan bilinci, bu ortak kurguda kendini bulurken, aslında evrensel bir anlayışın parçası haline gelmektedir. Sonuç olarak varlık felsefesi, insan erişiminin dijital boşluğun sonsuz olanaklarıyla bütünleşmesi hakkındadır."
                    ]},
                    { id: "ch2", title: "2. Yapay Zeka", paragraphs: ["AI Content...","Para 2...","Para 3..."] },
                    { id: "ch3", title: "3. BCI Sıçraması", paragraphs: ["BCI Content...","Para 2...","Para 3..."] },
                    { id: "ch4", title: "4. 6G Altyapısı", paragraphs: ["6G Content...","Para 2...","Para 3..."] },
                    { id: "ch5", title: "5. Dijital Ekonomi", paragraphs: ["Economy...","Para 2...","Para 3..."] },
                    { id: "ch6", title: "6. Akışkan Kimlik", paragraphs: ["Identity...","Para 2...","Para 3..."] },
                    { id: "ch7", title: "7. Dijital Etik", paragraphs: ["Ethics...","Para 2...","Para 3..."] },
                    { id: "ch8", title: "8. Sanat ve Yaratıcılık", paragraphs: ["Art...","Para 2...","Para 3..."] },
                    { id: "ch9", title: "9. Hukuk ve Egemenlik", paragraphs: ["Law...","Para 2...","Para 3..."] },
                    { id: "ch10", title: "10. Final Sentezi", paragraphs: ["Synthesis...","Para 2...","Para 3..."] }
                ]
            },
            fa: {
                dir: "rtl", langCode: "fa", pdf: "pdf/Metavers_Leaps_Brief_Book -Persian.pdf",
                title: "جهش‌های فناوری در متاورس", author: "فرامرز کوثری", isbn: "۹۷۸-۶۲۲-۰۲-۲۳۵۶-۶",
                download: "دریافت PDF فارسی", authorLabel: "درباره نویسنده", pubDetails: "شناسنامه انتشار",
                chapters: [
                    { id: "ch1", title: "۱. فلسفه حضور", paragraphs: [
                        "مفهوم حضور در متاورس نشان‌دهنده یک جهش هستی‌شناختی عمیق در تجربه انسانی است که مرزهای میان واقعیت فیزیکی و بازنمایی دیجیتال را به چالش می‌کشد. این پدیده تنها یک شبیه‌سازی گرافیکی نیست بلکه ادغام عملکردی آگاهی در یک اکوسیستم دیجیتالی با فرکانس بالا محسوب می‌شود. ما باید تشخیص دهیم که زیست دیجیتال، شبیه‌سازی واقعیت نیست، بلکه گسترش اراده انسانی به ابعاد نوین است. این انتقال نیازمند بازنگری کامل در مفهوم کوالیا است که محرک‌های الگوریتمیک را جایگزین می‌کند. پلاستیسیته مغز انسان اجازه می‌دهد تا محرک‌های سنتزی را در صورت تطابق الگو به عنوان داده‌های اولیه محیطی بپذیرد. در نتیجه مرز میان فضای فیزیکی و قلمرو مجازی به تدریج تحت تأثیر همزمانی بازخوردها از بین می‌رود. ما شاهد ظهور یک وضعیت انسانی پسا-جغرافیایی هستیم که در آن مفهوم محلی بودن بازتعریف می‌شود. این تغییر مستلزم یک معرفت‌شناسی جدید است که برای اصالت تعامل ارزش والایی قائل است. تجربه ذهنی در فضاهای مجازی با رسیدن حلقه‌های بازخورد حسی به دقت میلی‌ثانیه، واقعی خواهد شد. در نهایت تمدن آینده بر پایه این حضور یکپارچه استوار خواهد بود که فاصله‌ها را حذف می‌کند.",
                        "در مرحله دوم از بررسی فلسفی حضور، ما به ماهیت زمانی در دنیای دیجیتال و پایداری داده‌ها می‌پردازیم. در متاورس هر رخداد به صورت یک کد ماندگار در شبکه ثبت می‌شود و امکان بازگشت را فراهم می‌کند. این ماندگاری اطلاعات باعث می‌شود تا مفهوم میراث انسانی از خاطرات به معماری‌های قابل پیمایش تبدیل شود. ما باید بیاموزیم که چگونه هویت خود را در محیطی که فاقد آنتروپی بیولوژیک است مدیریت کنیم. نبود زوال ماده در فضای مجازی نوعی کمال ایستا ایجاد می‌کند که چالش‌های روان‌شناختی جدیدی دارد. برای جلوگیری از حس غریبگی ذهن، باید فرسودگی‌های دیجیتال به صورت عمدی در طراحی‌ها گنجانده شوند. پذیرش منطق دیجیتال به عنوان یک واقعیت مستقل نشان‌دهنده بلوغ تمدن ما در این عصر است. ما از مرحله تقلید از طبیعت عبور کرده‌ایم و اکنون به مرحله اصلاح قوانین حاکم بر واقعیت رسیده‌ایم. متافیزیک متاورس در لایه‌های کد نهفته است که به تدریج جایگزین اتم‌ها در تعریف حقیقت می‌شوند. همگرایی میان تجربه مستقیم و واسطه‌مند غایت اصلی این فلسفه نوین در قرن بیست و یکم است.",
                        "بُعد سوم این فلسفه بر دموکراتیزه کردن ایده‌آل و حذف نایابی فیزیکی به عنوان مانعی بزرگ تمرکز دارد. در متاورس ساخت یک شاهکار معماری جهانی هزینه‌ای بیشتر از یک کلبه ساده ندارد و تخیل حاکم است. این توزیع مجدد قدرت خلاقه اجازه می‌دهد تا یک شایسته‌سالاری جهانی بدون توجه به ثروت فیزیکی افراد شکل بگیرد. دسترسی به حضور با کیفیت بالا باید در عصر دیجیتال به عنوان یک حق بنیادین بشری شناخته شود. اگر متاورس به جزیره‌های محصور شرکتی تقسیم شود، ایده وحدت تجربه بشری به خطر می‌افزاید. این قطعه‌قطعه شدن حقیقت، خطرناک‌ترین چالش پیش روی تمدن دیجیتال است که باید با پروتکل باز حل شود. حاکمیت خودِ دیجیتال نیازمند توانایی حرکت آزادانه میان جهان‌ها با حفظ کامل دارایی‌ها و هویت است. ما همچنین باید نقش طبیعت را در دنیایی از پیکسل‌ها بررسی کنیم تا فواید روان‌شناختی آن را بسنجیم. شواهد علوم اعصاب نشان می‌دهد که مغز به الگوهای طبیعی در هر دو محیط واکنش مشابهی نشان می‌دهد. در نهایت فلسفه حضور به دنبال گسترش دسترسی انسان به ابعاد جدید وجودی بدون محدودیت‌های مادی است."
                    ]},
                    { id: "ch2", title: "۲. هوش مصنوعی مولد", paragraphs: ["محتوای هوش مصنوعی...","پاراگراف ۲...","پاراگراف ۳..."] },
                    { id: "ch3", title: "۳. رابط‌های مغز و رایانه", paragraphs: ["محتوای BCI...","پاراگراف ۲...","پاراگراف ۳..."] },
                    { id: "ch4", title: "۴. زیرساخت‌های 6G", paragraphs: ["محتوای 6G...","پاراگراف ۲...","پاراگراف ۳..."] },
                    { id: "ch5", title: "۵. اقتصاد متاورسی", paragraphs: ["محتوای اقتصاد...","پاراگراف ۲...","پاراگراف ۳..."] },
                    { id: "ch6", title: "۶. هویت سیال", paragraphs: ["محتوای هویت...","پاراگراف ۲...","پاراگراف ۳..."] },
                    { id: "ch7", title: "۷. اخلاق دیجیتال", paragraphs: ["محتوای اخلاق...","پاراگراف ۲...","پاراگراف ۳..."] },
                    { id: "ch8", title: "۸. هنر و خلاقیت", paragraphs: ["محتوای هنر...","پاراگراف ۲...","پاراگراف ۳..."] },
                    { id: "ch9", title: "۹. حقوق و حاکمیت", paragraphs: ["محتوای حقوق...","پاراگراف ۲...","پاراگراف ۳..."] },
                    { id: "ch10", title: "۱۰. سنتز نهایی", paragraphs: ["محتوای سنتز...","پاراگراف ۲...","پاراگراف ۳..."] }
                ]
            }
        };

        const App = () => {
            const [lang, setLang] = useState('en'); 
            const [activeChapterId, setActiveChapterId] = useState('ch1');
            const [isSidebarOpen, setIsSidebarOpen] = useState(false);
            const [audioLoading, setAudioLoading] = useState(false);
            const [isPlaying, setIsPlaying] = useState(false);
            const [audioUrl, setAudioUrl] = useState(null);
            const audioRef = useRef(null);
            
            const current = bookData[lang] || bookData['en'];

            const toggleLang = (l) => {
                if (!bookData[l]) return;
                setLang(l);
                setAudioUrl(null);
                setIsPlaying(false);
                document.documentElement.dir = bookData[l].dir;
                document.documentElement.lang = l;
            };

            const handleTTS = async () => {
                if (lang === 'fa') return;
                if (audioUrl) { setIsPlaying(!isPlaying); return; }
                setAudioLoading(true);
                try {
                    const chapter = current.chapters.find(c => c.id === activeChapterId);
                    const textToRead = chapter.paragraphs.join(" ");
                    const voice = lang === 'en' ? "Kore" : "Sadaltager";
                    const apiKey = ""; // API key is handled by the environment
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: `Narrate professionally: ${textToRead}` }] }],
                            generationConfig: {
                                responseModalities: ["AUDIO"],
                                speechConfig: { voiceConfig: { prebuiltVoiceConfig: { voiceName: voice } } }
                            }
                        })
                    });
                    const result = await response.json();
                    const pcmData = result.candidates?.[0]?.content?.parts?.[0]?.inlineData?.data;
                    if (!pcmData) throw new Error("Audio generation failed");
                    const wavBlob = pcmToWav(pcmData, 24000);
                    setAudioUrl(URL.createObjectURL(wavBlob));
                    setIsPlaying(true);
                } catch (error) { console.error(error); } finally { setAudioLoading(false); }
            };

            const pcmToWav = (base64Pcm, sampleRate) => {
                const buffer = Uint8Array.from(atob(base64Pcm), c => c.charCodeAt(0));
                const header = new ArrayBuffer(44);
                const view = new DataView(header);
                const writeString = (o, s) => { for (let i = 0; i < s.length; i++) view.setUint8(o + i, s.charCodeAt(i)); };
                writeString(0, 'RIFF'); view.setUint32(4, 36 + buffer.length, true);
                writeString(8, 'WAVE'); writeString(12, 'fmt ');
                view.setUint32(16, 16, true); view.setUint16(20, 1, true); view.setUint16(22, 1, true);
                view.setUint32(24, sampleRate, true); view.setUint32(28, sampleRate * 2, true);
                view.setUint16(32, 2, true); view.setUint16(34, 16, true);
                writeString(36, 'data'); view.setUint32(40, buffer.length, true);
                return new Blob([header, buffer], { type: 'audio/wav' });
            };

            useEffect(() => {
                if (audioRef.current) {
                    if (isPlaying) audioRef.current.play().catch(() => setIsPlaying(false));
                    else audioRef.current.pause();
                }
            }, [isPlaying, audioUrl]);

            return (
                <div className="flex min-h-screen relative">
                    {/* Mobile Header */}
                    <div className="lg:hidden fixed top-0 left-0 w-full glass-panel z-[60] flex justify-between items-center p-4 shadow-xl">
                        <button onClick={() => setIsSidebarOpen(!isSidebarOpen)} className="p-2 text-[#deff9a]">
                            {isSidebarOpen ? <IconX /> : <IconMenu />}
                        </button>
                        <span className="font-bold gradient-text tracking-tighter">METAVERSE LEAPS</span>
                    </div>

                    {/* Sidebar */}
                    <aside className={`w-80 glass-panel h-screen fixed top-0 flex flex-col p-8 z-50 transition-all duration-500 sidebar-mobile ${isSidebarOpen ? 'open shadow-[0_0_50px_rgba(0,0,0,0.8)]' : ''} ${lang === 'fa' ? 'right-0 lg:border-l' : 'left-0 lg:border-r'} lg:translate-x-0`}>
                        <div className="mb-8 pt-12 lg:pt-0">
                            <h1 className="text-2xl font-black gradient-text tracking-tighter leading-tight">{current.title}</h1>
                            <p className="text-gray-500 text-[10px] mt-2 font-bold uppercase tracking-widest">{current.author}</p>
                        </div>

                        {/* Language Switcher in Sidebar */}
                        <div className="mb-8 flex gap-1 bg-white/5 p-1 rounded-2xl border border-white/5">
                            {['fa', 'tr', 'en'].map(l => (
                                <button key={l} onClick={() => toggleLang(l)} 
                                    className={`flex-1 py-2 rounded-xl text-[10px] font-black uppercase transition-all ${lang === l ? 'bg-[#deff9a] text-black shadow-md' : 'text-gray-400 hover:text-white'}`}
                                >{l}</button>
                            ))}
                        </div>
                        
                        <nav className="flex-grow overflow-y-auto space-y-1 custom-scroll pr-2 pl-2">
                            {current.chapters.map(ch => (
                                <button key={ch.id} 
                                    onClick={() => { setActiveChapterId(ch.id); setAudioUrl(null); setIsPlaying(false); setIsSidebarOpen(false); window.scrollTo(0,0); }}
                                    className={`sidebar-link w-full py-3 px-4 rounded-xl text-xs transition-all ${lang === 'fa' ? 'text-right' : 'text-left'} ${activeChapterId === ch.id ? 'active' : 'text-gray-500 hover:text-white hover:bg-white/5'}`}
                                >{ch.title}</button>
                            ))}
                        </nav>

                        <div className="mt-8 pt-8 border-t border-white/5 space-y-6">
                            <div className="author-card p-4 rounded-2xl bg-white/5 border border-white/5">
                                <p className="text-[10px] text-gray-500 mb-3 font-bold uppercase tracking-widest">{current.authorLabel}</p>
                                <div className="flex flex-col gap-3">
                                    <a href="mailto:info@faramarzkowsari.com" className="flex items-center gap-2 text-[11px] text-gray-300 hover:text-[#deff9a] transition-colors"><IconMail /> info@faramarzkowsari.com</a>
                                    <a href="https://www.linkedin.com/in/faramarzkowsari" target="_blank" className="flex items-center gap-2 text-[11px] text-gray-300 hover:text-[#deff9a] transition-colors"><IconLinkedin /> LinkedIn</a>
                                    <a href="https://play.google.com/store/search?q=faramarz%20kowsari&c=books" target="_blank" className="flex items-center gap-2 text-[11px] text-gray-300 hover:text-[#deff9a] transition-colors"><IconGlobe /> Google Books</a>
                                </div>
                            </div>
                            <a href={`./${current.pdf}`} download className="flex items-center justify-center gap-2 bg-[#deff9a] text-black py-4 rounded-2xl font-bold text-xs hover:scale-105 transition-transform shadow-lg">
                                <IconDownload /> {current.download}
                            </a>
                        </div>
                    </aside>

                    {/* Main Content */}
                    <main className={`flex-grow p-6 md:p-12 lg:p-20 transition-all duration-500 ${lang === 'fa' ? 'lg:mr-80' : 'lg:ml-80'} pt-24 lg:pt-20 bg-black/20`}>
                        <div className="page-container">
                            <article className="animate-in fade-in slide-in-from-bottom-6 duration-1000">
                                {current.chapters.filter(ch => ch.id === activeChapterId).map(ch => (
                                    <div key={ch.id}>
                                        <h2 className="text-4xl md:text-6xl font-black mb-12 gradient-text tracking-tighter leading-tight drop-shadow-sm">{ch.title}</h2>
                                        
                                        {activeChapterId === 'ch1' && (
                                            <div className="mb-16 lg:mb-20 p-6 lg:p-10 glass-panel rounded-[2.5rem] lg:rounded-[4rem] border border-[#deff9a]/10 bg-white/[0.01]">
                                                <div className="flex flex-col md:flex-row gap-10 items-center justify-between">
                                                    <div className="w-full md:w-1/2 rounded-3xl overflow-hidden shadow-[0_30px_60px_rgba(0,0,0,0.7)] border border-white/5 bg-black/40 aspect-[3/4]">
                                                        <img 
                                                            src="images/img01.png" 
                                                            className="w-full h-full object-cover" 
                                                            alt="Book Cover"
                                                            onError={(e) => { e.target.src = 'https://images.unsplash.com/photo-1614850523296-d8c1af93d400?w=800&q=80'; }}
                                                        />
                                                    </div>
                                                    <div className="flex flex-col items-center md:items-end gap-6">
                                                        <div className={`${lang === 'fa' ? 'text-right' : 'text-left'} md:text-right`}>
                                                            <p className="text-[11px] uppercase tracking-[0.3em] text-gray-500 font-bold mb-2 opacity-60">{current.pubDetails}</p>
                                                            <p className="text-lg font-bold text-white mb-6 font-mono tracking-wider">{current.isbn}</p>
                                                        </div>
                                                        <div className="bg-white p-4 rounded-xl shadow-2xl scale-110">
                                                            <Barcode />
                                                            <p className="text-[10px] text-black font-mono text-center mt-2 font-bold tracking-tighter">{current.isbn}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        )}

                                        <div className="space-y-2">
                                            {ch.paragraphs.map((p, i) => (
                                                <p key={i} className="paragraph-text">
                                                    {p}
                                                </p>
                                            ))}
                                        </div>
                                    </div>
                                ))}
                            </article>

                            <footer className="mt-40 pt-16 border-t border-white/5 text-center opacity-30">
                                <p className="text-xs font-bold tracking-widest uppercase mb-4">Metaverse Leaps &copy; 2022</p>
                                <p className="text-[10px] font-light max-w-md mx-auto leading-relaxed">{lang === 'fa' ? 'تمامی حقوق مادی و معنوی محفوظ است.' : 'All rights reserved.'}</p>
                            </footer>
                        </div>
                    </main>

                    {/* Mini Player */}
                    <div className={`fixed bottom-8 lg:bottom-12 z-[100] ${lang === 'fa' ? 'left-8 lg:left-12' : 'right-8 lg:right-12'}`}>
                        <div className="mini-player glass-panel p-3 md:p-4 rounded-full flex items-center gap-4 shadow-2xl shadow-black border border-white/10 backdrop-blur-2xl">
                            <button onClick={handleTTS} disabled={lang === 'fa' || audioLoading} className={`w-14 h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center transition-all ${lang === 'fa' ? 'opacity-10 cursor-not-allowed bg-white/5' : 'bg-[#deff9a] text-black hover:scale-110 shadow-[0_10px_30px_rgba(222,255,154,0.3)]'}`}>
                                {audioLoading ? <div className="loader"></div> : (isPlaying ? <IconPause /> : <IconPlay />)}
                            </button>
                            {lang !== 'fa' && (
                                <div className="pr-4 border-r border-white/10 hidden md:block">
                                    <p className="text-[10px] font-black uppercase text-[#deff9a] tracking-[0.2em]">AI Narration</p>
                                    <div className="flex items-center gap-3 mt-1.5">
                                        <IconVolume />
                                        <div className="w-24 md:w-32 h-1.5 bg-white/10 rounded-full overflow-hidden">
                                            <div className={`h-full bg-[#deff9a] transition-all duration-500 ${isPlaying ? 'w-full' : 'w-1/3'}`}></div>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                    {audioUrl && <audio ref={audioRef} src={audioUrl} onEnded={() => setIsPlaying(false)} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
